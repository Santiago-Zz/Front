import{a as V}from"./chunk-YBBVXVAR.js";import{b as B,e as D,g as N}from"./chunk-GRKPEBUD.js";import{a as L}from"./chunk-PJICVWY7.js";import{a as z}from"./chunk-3WWZO66B.js";import{p as R}from"./chunk-K76AGWZU.js";import"./chunk-WXI33M2S.js";import"./chunk-PLQB32H7.js";import"./chunk-O37MA7DD.js";import{k as I,l as O,m as A,n as $,o as j}from"./chunk-Q5ELIKLH.js";import{Ab as f,Bb as y,Hb as S,Ib as T,Jb as k,Kb as M,Lb as E,Mb as F,Na as P,Ra as a,Sa as u,da as C,eb as g,ib as d,kb as h,ma as _,mb as n,na as v,nb as o,ob as s,rb as x,vb as m,wb as p,xb as w,zb as r}from"./chunk-PUIGTLMT.js";var q=(l,t)=>({"col-md-12":l,"col-md-9":t}),J=()=>["/create-product"],G=l=>["/edit-product",l];function H(l,t){l&1&&(n(0,"div",32)(1,"button",33),s(2,"i",34),r(3," Crear nuevo producto "),o()()),l&2&&(a(),d("routerLink",T(1,J)))}function K(l,t){if(l&1&&(n(0,"li",35)(1,"label",36),s(2,"input",37),r(3),o(),n(4,"span",38),r(5),o()()),l&2){let e=t.$implicit;a(2),d("value",e.name),a(),y(" ",e.name," "),a(2),f(e.count)}}function Q(l,t){if(l&1){let e=x();n(0,"div",50)(1,"button",51),s(2,"i",52),r(3," Editar "),o(),n(4,"button",53),m("click",function(){_(e);let c=p().$implicit,b=p();return v(b.deleteProduct(c.products_Id))}),s(5,"i",54),r(6," Eliminar "),o()()}if(l&2){let e=p().$implicit;a(),d("routerLink",k(1,G,e.products_Id))}}function W(l,t){if(l&1){let e=x();n(0,"div",55)(1,"button",56),m("click",function(){_(e);let c=p().$implicit,b=p();return v(b.addToCart(c))}),s(2,"i",57),r(3," Agregar al carrito "),o()()}}function X(l,t){if(l&1&&(n(0,"div",39)(1,"div",40)(2,"div",41),s(3,"img",42),o(),n(4,"div",43)(5,"div",44)(6,"h5",45),r(7),o(),n(8,"h5",46),r(9),E(10,"currency"),o()(),n(11,"p",47),r(12),o()(),g(13,Q,7,3,"div",48)(14,W,4,0,"div",49),o()()),l&2){let e=t.$implicit,i=p();a(3),w("alt",e.name),d("src",e.image_url,P),a(4),f(e.name),a(2),f(F(10,7,e.price)),a(3),y(" ",e.description||"Descripci\xF3n no disponible."," "),a(),d("ngIf",i.isAdmin),a(),d("ngIf",!i.isAdmin)}}var U=class l{constructor(t,e,i,c){this.productService=t;this.route=e;this.toastr=i;this.cartService=c}brands=[{name:"Marca A",count:37},{name:"Marca B",count:30},{name:"Marca C",count:16},{name:"Marca D",count:14}];products=[];categoryId;minPrice=0;maxPrice=0;showFilters=!1;showSort=!0;isAdmin=!1;showCreateForm=!1;loading=!1;ngOnInit(){let t=Number(this.route.snapshot.paramMap.get("categoryId"));console.log("ID de categor\xEDa capturado:",t),t&&(console.log("ID de la categor\xEDa:",t),this.loadProductsByCategory(Number(t)));let e=localStorage.getItem("authToken");if(e){let i=this.decodeToken(e);i&&i.role==="admin"?this.isAdmin=!0:this.isAdmin=!1,console.log("isAdmin:",this.isAdmin)}else console.error("No se encontr\xF3 ning\xFAn token en localStorage.")}loadProductsByCategory(t){this.productService.getProductsByCategory(t).subscribe(e=>{this.products=e,console.log("Productos cargados:",this.products)},e=>{console.error("Error al cargar productos:",e)})}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(e){return console.error("Error decodificando el token:",e),null}}editProduct(t){this.isAdmin&&console.log(`Editando el producto con ID: ${t.products_Id}`)}deleteProduct(t){console.log("ID del producto a eliminar:",t),this.isAdmin&&this.productService.deleteProduct(t).subscribe(()=>{this.loadProductsByCategory(this.categoryId),this.toastr.warning("El producto fue eliminado con \xE9xito.","Producto eliminado")})}toggleFilters(){this.showFilters=!this.showFilters;let t=document.getElementById("filterText");t&&(t.textContent=this.showFilters?"Ocultar filtros":"Mostrar filtros")}sort(t){t==="asc"?this.products.sort((e,i)=>e.price-i.price):t==="desc"&&this.products.sort((e,i)=>i.price-e.price),console.log("productos ordenados: ",this.products)}applyPriceFilter(t,e){(t===void 0||e===void 0)&&(t=this.minPrice,e=this.maxPrice),console.log(`Aplicando filtro de precio: ${t} - ${e}`)}addToCart(t){this.cartService.addToCart(t),console.log(`${t.name} agregado al carrito`)}static \u0275fac=function(e){return new(e||l)(u(L),u(B),u(z),u(V))};static \u0275cmp=C({type:l,selectors:[["app-tools"]],standalone:!0,features:[S],decls:57,vars:11,consts:[[1,"container-fluid","mt-4"],["class","my-3",4,"ngIf"],[1,"row","d-flex-wrap"],[1,"col-md-12","d-flex","justify-content-end","mb-5","gap-2"],["id","toggleFiltersBtn",1,"btn","btn-outline-primary","d-flex","align-items-center",3,"click"],[1,"bi","bi-funnel"],["id","filterText",1,"ms-2"],[1,"dropdown"],["type","button","id","dropdownSortButton","data-bs-toggle","dropdown","aria-expanded","false",1,"btn","btn-outline-secondary","dropdown-toggle","d-flex","align-items-center"],[1,"bi","bi-sort-down-alt"],[1,"ms-2"],["aria-labelledby","dropdownSortButton",1,"dropdown-menu"],[1,"dropdown-item",3,"click"],["id","filterMenu",1,"col-md-3","filters","bg-light","p-3","shadow-lg","rounded"],[1,"mb-4"],[1,"filter-group","mb-4"],[1,"text-primary"],[1,"list-group"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"list-group-item",3,"click"],[1,"d-flex","mb-2"],[1,"input-group","me-2"],[1,"input-group-text"],["type","number","placeholder","Min",1,"form-control"],[1,"input-group"],["type","number","placeholder","Max",1,"form-control"],[1,"btn","btn-primary","w-100",3,"click"],[3,"ngClass"],[1,"container","mt-5"],[1,"products"],[1,"row","row-cols-1","row-cols-md-3","g-4"],["class","col",4,"ngFor","ngForOf"],[1,"my-3"],[1,"btn","btn-outline-danger","d-flex","align-items-center",3,"routerLink"],[1,"bi","bi-plus-circle","me-2"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"form-check-label","d-flex","align-items-center"],["type","checkbox",1,"form-check-input","me-2",3,"value"],[1,"badge","bg-primary","rounded-pill"],[1,"col"],[1,"card","text-dark","bg-white","shadow-sm","rounded-lg","h-100"],[1,"overflow-hidden","rounded-top",2,"height","180px"],[1,"card-img-top",2,"object-fit","contain","width","100%","height","100%",3,"src","alt"],[1,"card-body"],[1,"d-flex","justify-content-between","mb-2","gap-2"],[1,"card-title","mb-0"],[1,"card-title","mb-0","text-primary"],[1,"card-text","text-muted","mt-2"],["class","card-footer bg-white border-0 d-flex justify-content-between",4,"ngIf"],["class","card-footer bg-white border-0",4,"ngIf"],[1,"card-footer","bg-white","border-0","d-flex","justify-content-between"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"bi","bi-pencil-square"],[1,"btn","btn-outline-danger",3,"click"],[1,"bi","bi-trash"],[1,"card-footer","bg-white","border-0"],[1,"btn","btn-success","w-100","text-uppercase","fw-bold","py-2",3,"click"],[1,"bi","bi-cart-plus","me-2"]],template:function(e,i){e&1&&(n(0,"div",0),g(1,H,4,2,"div",1),n(2,"div",2)(3,"div",3)(4,"button",4),m("click",function(){return i.toggleFilters()}),s(5,"i",5),n(6,"span",6),r(7,"Mostrar filtros"),o()(),n(8,"div",7)(9,"button",8),s(10,"i",9),n(11,"span",10),r(12,"M\xE1s reciente"),o()(),n(13,"ul",11)(14,"li")(15,"a",12),m("click",function(){return i.sort("desc")}),r(16,"Precio: alto-bajo"),o()(),n(17,"li")(18,"a",12),m("click",function(){return i.sort("asc")}),r(19,"Precio: bajo-alto"),o()()()()(),n(20,"aside",13)(21,"h3",14),r(22,"Filtrar"),o(),n(23,"div",15)(24,"h5",16),r(25,"Marcas"),o(),n(26,"ul",17),g(27,K,6,3,"li",18),o()(),n(28,"div",15)(29,"h5",16),r(30,"Rango de precios"),o(),n(31,"ul",17)(32,"li",19),m("click",function(){return i.minPrice=0,i.maxPrice=25e4,i.applyPriceFilter()}),r(33," $0 - $250.000 "),o(),n(34,"li",19),m("click",function(){return i.minPrice=250001,i.maxPrice=5e5,i.applyPriceFilter()}),r(35," $250.000 - $500.000 "),o(),n(36,"li",19),m("click",function(){return i.minPrice=500001,i.maxPrice=1e6,i.applyPriceFilter()}),r(37," $500.000 - $1.000.000 "),o()()(),n(38,"div",15)(39,"h5",16),r(40,"Rango personalizado"),o(),n(41,"div",20)(42,"div",21)(43,"span",22),r(44,"$"),o(),s(45,"input",23),o(),n(46,"div",24)(47,"span",22),r(48,"$"),o(),s(49,"input",25),o()(),n(50,"button",26),m("click",function(){return i.applyPriceFilter()}),r(51,"Aplicar"),o()()(),n(52,"div",27)(53,"div",28)(54,"div",29)(55,"div",30),g(56,X,15,9,"div",31),o()()()()()()),e&2&&(a(),d("ngIf",i.isAdmin),a(19),h("hidden",!i.showFilters),a(7),d("ngForOf",i.brands),a(25),d("ngClass",M(8,q,!i.showFilters,i.showFilters)),a(2),h("expanded",!i.showFilters),a(2),d("ngForOf",i.products))},dependencies:[j,I,O,A,$,R,N,D],styles:['@charset "UTF-8";.container-fluid[_ngcontent-%COMP%]{margin:20px}.filters[_ngcontent-%COMP%]{max-width:450px;height:100%;display:flex;flex-direction:column;justify-content:flex-start}.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{margin-bottom:20px}.apply-btn[_ngcontent-%COMP%]{margin-bottom:0}.filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.d-flex[_ngcontent-%COMP%]{gap:10px}.card[_ngcontent-%COMP%]{margin-bottom:20px}.card-body[_ngcontent-%COMP%]{padding:15px}.card-footer[_ngcontent-%COMP%]{padding:10px}.card-img-top[_ngcontent-%COMP%]{object-fit:contain!important}.btn-outline-warning[_ngcontent-%COMP%], .btn-outline-danger[_ngcontent-%COMP%]{margin:5px;transition:background-color .2s ease,color .2s ease}.btn-outline-warning[_ngcontent-%COMP%]:hover{background-color:#dcca06;color:#fff}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;color:#fff}.btn-success[_ngcontent-%COMP%]{margin-top:10px}#toggleFiltersBtn[_ngcontent-%COMP%], .dropdown-toggle[_ngcontent-%COMP%]{font-size:1rem;padding:.5rem 1rem;margin-right:5px}#dropdownSortButton[_ngcontent-%COMP%]{margin-right:25px}.hidden[_ngcontent-%COMP%]{display:none!important}@media (max-width: 768px){.filters[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}.products[_ngcontent-%COMP%]{width:100%;margin-left:0}}']})};export{U as ToolsComponent};
