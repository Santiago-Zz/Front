import{b as R,d as j}from"./chunk-3YR7BGO7.js";import{a as X}from"./chunk-ERV5GOCI.js";import{a as Z}from"./chunk-UCTFNYLZ.js";import{a as G,b as m,c as L,d as B,g as z,h as Y,i as $,j as H,k as J,l as K,m as Q,o as U,q as W}from"./chunk-JPVO3FME.js";import"./chunk-XAZLOLJU.js";import"./chunk-3MSBGUPK.js";import"./chunk-FSVENPIU.js";import{k,m as A,o as V}from"./chunk-UEWRNPXW.js";import{Ab as T,Bb as D,Hb as w,Jb as p,Ra as l,Sa as g,da as N,eb as c,ib as a,mb as n,nb as i,ob as _,vb as P,wb as f,zb as d}from"./chunk-4YPG6D4H.js";var s=o=>({"is-invalid":o});function te(o,r){o&1&&(n(0,"div"),d(1,"El nombre del producto es obligatorio."),i())}function re(o,r){if(o&1&&(n(0,"div",22),c(1,te,2,0,"div",23),i()),o&2){let t,e=f();l(),a("ngIf",(t=e.productForm.get("name"))==null||t.errors==null?null:t.errors.required)}}function oe(o,r){o&1&&(n(0,"div"),d(1,"El precio es obligatorio."),i())}function ie(o,r){o&1&&(n(0,"div"),d(1,"El precio debe ser mayor o igual a 0."),i())}function ne(o,r){if(o&1&&(n(0,"div",22),c(1,oe,2,0,"div",23)(2,ie,2,0,"div",23),i()),o&2){let t,e,u=f();l(),a("ngIf",(t=u.productForm.get("price"))==null||t.errors==null?null:t.errors.required),l(),a("ngIf",(e=u.productForm.get("price"))==null||e.errors==null?null:e.errors.min)}}function le(o,r){o&1&&(n(0,"div"),d(1,"La descripci\xF3n es obligatoria."),i())}function ae(o,r){if(o&1&&(n(0,"div",22),c(1,le,2,0,"div",23),i()),o&2){let t,e=f();l(),a("ngIf",(t=e.productForm.get("description"))==null||t.errors==null?null:t.errors.required)}}function de(o,r){o&1&&(n(0,"div"),d(1,"La cantidad es obligatoria."),i())}function ue(o,r){o&1&&(n(0,"div"),d(1,"La cantidad debe ser mayor o igual a 0."),i())}function ce(o,r){if(o&1&&(n(0,"div",22),c(1,de,2,0,"div",23)(2,ue,2,0,"div",23),i()),o&2){let t,e,u=f();l(),a("ngIf",(t=u.productForm.get("quantity"))==null||t.errors==null?null:t.errors.required),l(),a("ngIf",(e=u.productForm.get("quantity"))==null||e.errors==null?null:e.errors.min)}}function me(o,r){o&1&&(n(0,"div",22),d(1," La imagen es obligatoria. "),i())}function pe(o,r){o&1&&(n(0,"div",22),d(1," El estado es obligatorio. "),i())}function se(o,r){o&1&&(n(0,"div",22),d(1," La categor\xEDa es obligatoria. "),i())}var ee=class o{constructor(r,t,e,u,v){this.fb=r;this.route=t;this.productService=e;this.router=u;this.toastr=v;this.productForm=this.fb.group({name:["",m.required],price:[0,[m.required,m.min(0)]],description:["",m.required],quantity:[0,[m.required,m.min(0)]],image_url:[null,m.required],status:["disponible",m.required],category_Id:[null,m.required]})}productForm;isEditMode=!1;products_Id=null;selectedFile=null;message="";products=[];ngOnInit(){this.route.paramMap.subscribe(r=>{let t=r.get("id");t&&!isNaN(+t)?(this.isEditMode=!0,this.products_Id=+t,this.loadProductData(this.products_Id)):console.error("ID del producto no v\xE1lido:",t)})}loadProductData(r){this.productService.getProductById(r).subscribe(t=>{this.productForm.patchValue({name:t.name,price:t.price,description:t.description,quantity:t.quantity,status:t.status,category_Id:t.category_Id})})}addProduct(){if(this.productForm.invalid)return;let r=new FormData;r.append("name",this.productForm.value.name),r.append("price",this.productForm.value.price.toString()),r.append("description",this.productForm.value.description),r.append("quantity",this.productForm.value.quantity.toString()),r.append("status",this.productForm.value.status),r.append("category_Id",this.productForm.value.category_Id.toString()),this.selectedFile?r.append("image_url",this.selectedFile,this.selectedFile.name):r.append("image_url",""),console.log("Objeto del producto enviado:",{name:this.productForm.value.name,price:this.productForm.value.price,description:this.productForm.value.description,quantity:this.productForm.value.quantity,status:this.productForm.value.status,category_Id:this.productForm.value.category_Id,image_url:this.selectedFile?this.selectedFile.name:null}),this.isEditMode?this.productService.updateProduct(this.products_Id,r).subscribe(()=>{this.toastr.info("El producto fue actualizado con \xE9xito","Producto actualizado"),this.router.navigate(["/home"])}):this.productService.createProduct(r).subscribe(()=>{this.toastr.success("Producto creado con \xE9xito","Creaci\xF3n"),this.productForm.reset(),this.router.navigate(["/"])},t=>{console.error("Error al crear el producto:",t),this.toastr.error("Error al crear el producto","Error")})}onEdit(r){console.log(`Editando el producto con ID: ${r.products_Id}`),this.router.navigate(["/edit-product",r.products_Id])}onFileChange(r){let t=r.target.files[0];t&&(this.selectedFile=t,this.productForm.patchValue({image_url:t}),this.productForm.get("image_url")?.updateValueAndValidity())}static \u0275fac=function(t){return new(t||o)(g(U),g(R),g(X),g(j),g(Z))};static \u0275cmp=N({type:o,selectors:[["app-product-form"]],standalone:!0,features:[w],decls:46,vars:32,consts:[[1,"product-form-container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","name"],["id","name","formControlName","name","type","text",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","price"],["id","price","formControlName","price","type","number",1,"form-control",3,"ngClass"],["for","description"],["id","description","formControlName","description",1,"form-control",3,"ngClass"],["for","quantity"],["id","quantity","formControlName","quantity","type","number",1,"form-control",3,"ngClass"],["for","image_url"],["id","image_url","type","file",1,"form-control",3,"change","ngClass"],["for","status"],["id","status","formControlName","status",1,"form-control",3,"ngClass"],["value","Disponible"],["value","Caducado"],["for","category_Id"],["id","category_Id","formControlName","category_Id","type","number",1,"form-control",3,"ngClass"],[1,"text-center"],["type","submit",1,"btn","btn-primary","mt-3",3,"disabled"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(t,e){if(t&1&&(n(0,"div",0)(1,"h2"),d(2),i(),n(3,"form",1),P("ngSubmit",function(){return e.addProduct()}),n(4,"div",2)(5,"label",3),d(6,"Nombre del producto:"),i(),_(7,"input",4),c(8,re,2,1,"div",5),i(),n(9,"div",2)(10,"label",6),d(11,"Precio del producto"),i(),_(12,"input",7),c(13,ne,3,2,"div",5),i(),n(14,"div",2)(15,"label",8),d(16,"Descripci\xF3n"),i(),_(17,"textarea",9),c(18,ae,2,1,"div",5),i(),n(19,"div",2)(20,"label",10),d(21,"Cantidad"),i(),_(22,"input",11),c(23,ce,3,2,"div",5),i(),n(24,"div",2)(25,"label",12),d(26,"Imagen"),i(),n(27,"input",13),P("change",function(v){return e.onFileChange(v)}),i(),c(28,me,2,0,"div",5),i(),n(29,"div",2)(30,"label",14),d(31,"Estado"),i(),n(32,"select",15)(33,"option",16),d(34,"Disponible"),i(),n(35,"option",17),d(36,"Caducado"),i()(),c(37,pe,2,0,"div",5),i(),n(38,"div",2)(39,"label",18),d(40,"Categor\xEDa"),i(),_(41,"input",19),c(42,se,2,0,"div",5),i(),n(43,"div",20)(44,"button",21),d(45),i()()()()),t&2){let u,v,F,E,b,S,y,M,q,O,C,h,x,I;l(2),T(e.isEditMode?"Modificar producto":"Crear producto"),l(),a("formGroup",e.productForm),l(4),a("ngClass",p(18,s,((u=e.productForm.get("name"))==null?null:u.invalid)&&((u=e.productForm.get("name"))==null?null:u.touched))),l(),a("ngIf",(v=e.productForm.get("name"))==null?null:v.errors),l(4),a("ngClass",p(20,s,((F=e.productForm.get("price"))==null?null:F.invalid)&&((F=e.productForm.get("price"))==null?null:F.touched))),l(),a("ngIf",(E=e.productForm.get("price"))==null?null:E.errors),l(4),a("ngClass",p(22,s,((b=e.productForm.get("description"))==null?null:b.invalid)&&((b=e.productForm.get("description"))==null?null:b.touched))),l(),a("ngIf",(S=e.productForm.get("description"))==null?null:S.errors),l(4),a("ngClass",p(24,s,((y=e.productForm.get("quantity"))==null?null:y.invalid)&&((y=e.productForm.get("quantity"))==null?null:y.touched))),l(),a("ngIf",(M=e.productForm.get("quantity"))==null?null:M.errors),l(4),a("ngClass",p(26,s,!e.selectedFile&&((q=e.productForm.get("image_url"))==null?null:q.touched))),l(),a("ngIf",!e.selectedFile&&((O=e.productForm.get("image_url"))==null?null:O.touched)),l(4),a("ngClass",p(28,s,((C=e.productForm.get("status"))==null?null:C.invalid)&&((C=e.productForm.get("status"))==null?null:C.touched))),l(5),a("ngIf",((h=e.productForm.get("status"))==null?null:h.invalid)&&((h=e.productForm.get("status"))==null?null:h.touched)),l(4),a("ngClass",p(30,s,((x=e.productForm.get("category_Id"))==null?null:x.invalid)&&((x=e.productForm.get("category_Id"))==null?null:x.touched))),l(),a("ngIf",((I=e.productForm.get("category_Id"))==null?null:I.invalid)&&((I=e.productForm.get("category_Id"))==null?null:I.touched)),l(2),a("disabled",e.productForm.invalid),l(),D(" ",e.isEditMode?"Modificar":"Crear producto"," ")}},dependencies:[W,z,K,Q,G,Y,J,L,B,$,H,V,k,A],styles:[".product-form-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px;border:1px solid #ddd;border-radius:8px;background-color:#f9f9f9}h2[_ngcontent-%COMP%]{font-family:Arial;font-weight:700;text-align:center;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{font-family:Arial;font-weight:700}.form-control[_ngcontent-%COMP%], .form-control-file[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:95%;padding:10px;margin-top:5px;border:1px solid #ddd;border-radius:4px}button[_ngcontent-%COMP%]{width:100%;border-radius:8px;cursor:pointer;display:inline-block;padding:10px 20px;font-size:14px;font-weight:700;color:#fff;background-color:#007bff;border:none;transition:all .3s ease;box-shadow:0 4px 6px #0000001a}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-3px);box-shadow:0 8px 12px #0003}.btn-primary[_ngcontent-%COMP%]{background-color:#28a745}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#218838}.btn-warning[_ngcontent-%COMP%]{background-color:#ffc107}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#e0a800}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333}button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 4px 6px #0000001a}"]})};export{ee as ProductFormComponent};
